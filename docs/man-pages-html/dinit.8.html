<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DINIT(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DINIT(8)</td>
    <td class="head-vol">Dinit - service management system</td>
    <td class="head-rtitle">DINIT(8)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">dinit - supervise processes and manage services</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp HP"><b>dinit</b> [OPTION]... [<i>service-name</i>]...</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><b>Dinit</b> is a process supervisor and service manager which can
    also function as a system <b>init</b> process. It has a small but functional
    feature set, offering service dependency handling, parallel startup,
    automatic rate-limited restart of failing processes, and service control
    functions.</p>
<p class="Pp">Dinit can be run as a system instance (when run as the root user
    or when specified via command line parameter) or as a user instance. This
    affects the default paths used to locate certain files.</p>
<p class="Pp">When run as PID 1, the first process, Dinit by default acts as a
    system manager and shuts down or reboots the system on request (including on
    receipt of certain signals). This is currently fully supported only on
    Linux. See <b>RUNNING AS SYSTEM MANAGER / PRIMARY INIT</b>.</p>
<p class="Pp">Dinit reads service descriptions from files located in a service
    description directory, normally one of <i>/etc/dinit.d</i>,
    <i>/usr/local/lib/dinit.d</i> or <i>/lib/dinit.d</i> for the system instance
    or just <i>$HOME/.config/dinit.d</i> when run as a user process. See
    <b>SERVICE DESCRIPTION FILES</b> for details of the service description
    format.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt id="d"><a class="permalink" href="#d"><b>-d</b> <i>dir</i>,
    <b>--services-dir</b> <i>dir</i></a></dt>
  <dd>Specifies <i>dir</i> as the directory containing service definition files.
      This can be specified multiple times for multiple service directories. The
      default directories are not searched for services when this option is
      provided.
    <p class="Pp">If not specified, the default is <i>$HOME/.config/dinit.d</i>
        or, for the system service manager, each of <i>/etc/dinit.d</i>,
        <i>/usr/local/lib/dinit.d</i>, and <i>/lib/dinit.d</i> (searched in that
        order).</p>
  </dd>
  <dt id="e"><a class="permalink" href="#e"><b>-e</b> <i>file</i>,
    <b>--env-file</b> <i>file</i></a></dt>
  <dd>Read initial environment from <i>file</i>. For the system init process,
      the default is <i>/etc/dinit/environment</i>; see <b>FILES</b>.</dd>
  <dt id="p"><a class="permalink" href="#p"><b>-p</b> <i>path</i>,
    <b>--socket-path</b> <i>path</i></a></dt>
  <dd>Specifies <i>path</i> as the path to the control socket used to listen for
      commands from the <b>dinitctl</b> program. The default for the system
      service manager is usually <i>/dev/dinitctl</i> (but can be configured at
      build time). For a user service manager the default is either
      <i>$XDG_RUNTIME_DIR/dinitctl</i> or <i>$HOME/.dinitctl</i>, depending on
      whether <i>$XDG_RUNTIME_DIR</i> is set.</dd>
  <dt id="F"><a class="permalink" href="#F"><b>-F</b> <i>fd</i>,
    <b>--ready-fd</b> <i>fd</i></a></dt>
  <dd>Specifies <i>fd</i> as the file descriptor number to report readiness to.
      Readiness means that the control socket is open and the service manager is
      ready to accept commands (e.g. via <b>dinitctl</b>). It does not mean that
      services are finished starting yet. The path to the currently open control
      socket is written on the file descriptor.</dd>
  <dt id="l"><a class="permalink" href="#l"><b>-l</b> <i>path</i>,
    <b>--log-file</b> <i>path</i></a></dt>
  <dd>Species <i>path</i> as the path to the log file, to which Dinit will log
      status and error messages. Note that when running as the system service
      manager, Dinit does not begin logging until the log service has started.
      Using this option inhibits logging via the syslog facility, however, all
      logging messages are duplicated as usual to the console (so long as no
      service owns the console).</dd>
  <dt id="s"><a class="permalink" href="#s"><b>-s</b>, <b>--system</b></a></dt>
  <dd>Run as the system service manager. This is the default if invoked as the
      root user. This option affects the default service definition directory
      and control socket path.</dd>
  <dt id="m"><a class="permalink" href="#m"><b>-m</b>,
    <b>--system-mgr</b></a></dt>
  <dd>Run as the system manager (perform operations directly related to machine
      startup and shutdown). This is the default when running as process ID 1.
      The main user-visible effect of this option is to invoke the
      <b>shutdown</b> program when a shutdown is requested (and after all
      services have stopped), and to provide some basic support for system
      recovery in case the <b>boot</b> service (or other specified service)
      cannot be started.</dd>
  <dt id="u"><a class="permalink" href="#u"><b>-u</b>, <b>--user</b></a></dt>
  <dd>Run as a user service manager. This is the opposite of <b>--system</b>,
      and is the default if not invoked as the root user.</dd>
  <dt id="o"><a class="permalink" href="#o"><b>-o</b>,
    <b>--container</b></a></dt>
  <dd>Run in &quot;container mode&quot;, i.e. do not perform system management
      functions (such as shutdown/reboot). The <b>dinit</b> daemon will simply
      exit rather than executing the <b>shutdown</b> program.</dd>
  <dt id="q"><a class="permalink" href="#q"><b>-q</b>, <b>--quiet</b></a></dt>
  <dd>Run with no output to the terminal/console. This disables service status
      messages and sets the log level for the console log to <b>NONE</b>.</dd>
  <dt id="b"><a class="permalink" href="#b"><b>-b</b> <i>path</i>,
    <b>--cgroup-path</b> <i>path</i></a></dt>
  <dd>Specify the path to resolve relative cgroup paths against. If service
      description settings contain relative cgroup paths, they will be resolved
      relative to this path. This option is only available if <b>dinit</b> is
      built with cgroups support.</dd>
  <dt id="help"><a class="permalink" href="#help"><b>--help</b></a></dt>
  <dd>Display brief help text and then exit.</dd>
  <dt id="version"><a class="permalink" href="#version"><b>--version</b></a></dt>
  <dd>Display version number and then exit.</dd>
  <dt>[<b>-t</b>] <i>service-name</i>, [<b>--service</b>]
    <i>service-name</i></dt>
  <dd>Specifies the name of a service that should be started (along with its
      dependencies). If none are specified, defaults to <i>boot</i> (which
      requires that a suitable service description for the <i>boot</i> service
      exists). Multiple services can be specified in which case they will each
      be started.
    <p class="Pp"><b>Note:</b> on Linux, if <b>dinit</b> is running as PID 1 and
        with UID 0, it may ignore &quot;naked&quot; service names (without
        preceding <b>--service</b>/<b>-t</b>) provided on the command line. See
        the <b>COMMAND LINE FROM KERNEL</b> section.</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="SERVICE_DESCRIPTION_FILES"><a class="permalink" href="#SERVICE_DESCRIPTION_FILES">SERVICE
  DESCRIPTION FILES</a></h1>
<p class="Pp">Service description files specify the parameters of each service.
    They are named for the service they describe, and are found in
    <i>/etc/dinit.d</i> for a system instance or <i>$HOME/.config/dinit.d</i>
    for a user instance.</p>
<p class="Pp">Service description files are read by Dinit on an &quot;as
    needed&quot; basis. Once a service description has been read the
    configuration can be altered or reloaded via the <b>dinitctl</b>(8) program
    (with some limitations).</p>
<p class="Pp">See <b>dinit-service</b>(5) for details of the format and
    available parameters.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SPECIAL_SERVICE_NAMES"><a class="permalink" href="#SPECIAL_SERVICE_NAMES">SPECIAL
  SERVICE NAMES</a></h1>
<p class="Pp">There are two service names that are &quot;special&quot; to
  Dinit.</p>
<p class="Pp">The <i>boot</i> service is the service that Dinit starts by
    default, if no other service names are provided when it is started.</p>
<p class="Pp">The <i>recovery</i> service is a service that Dinit will offer to
    start if boot appears to fail (that is, if all services stop without a
    shutdown command having been issued), when Dinit is running as system
    manager.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OPERATION"><a class="permalink" href="#OPERATION">OPERATION</a></h1>
<p class="Pp">On starting, Dinit starts the initial service(s) as specified on
    the command line. Starting a service also causes the dependencies of that
    service to start, and any service processes will not be launched until the
    dependencies are satisfied. Similarly, stopping a service first stops any
    dependent services.</p>
<p class="Pp">During execution, Dinit accepts commands via a control socket
    which is created by Dinit when it starts. This can be used to order that a
    service be started or stopped, to determine service status, or to make
    certain configuration changes. See <b>dinitctl</b>(8) for details. Dinit
    attempts to check for the existence of an already-active socket first, and
    will refuse to start if one exists. Unfortunately, this check cannot be done
    atomically, and should not be relied upon generally as a means to avoid
    starting two instances of dinit.</p>
<p class="Pp">Process-based services are monitored and, if the process
    terminates, the service may be stopped or the process may be re-started,
    according to the configuration in the service description.</p>
<p class="Pp">Once all services stop, the <b>dinit</b> daemon will itself
    terminate (or, if running as system manager, will perform the appropriate
    type of system shutdown).</p>
<section class="Ss">
<h2 class="Ss" id="CHARACTER_SET_HANDLING"><a class="permalink" href="#CHARACTER_SET_HANDLING">CHARACTER
  SET HANDLING</a></h2>
<p class="Pp">Dinit does no character set translation. Dinit's own output is in
    the execution character set as determined at compilation, as is the
    interpretation of input. Service names (and other user-defined inputs) are
    interpreted as byte sequences and are output as they were read. In general,
    modern systems use the UTF-8 character set universally and no problems will
    arise; however, systems configured to use other character sets may see odd
    behaviour if the input character set does not match the output character
    set, or if either input or output character sets are not a superset of the
    execution character set.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="RUNNING_AS_SYSTEM_MANAGER_/_PRIMARY_INIT"><a class="permalink" href="#RUNNING_AS_SYSTEM_MANAGER_/_PRIMARY_INIT">RUNNING
  AS SYSTEM MANAGER / PRIMARY INIT</a></h2>
<p class="Pp">Running as the system manager (primary <b>init</b>) is currently
    supported only on Linux. When run as process ID 1, the <b>dinit</b> daemon
    by default assumes responsibility for system shutdown and restart (partially
    relying on external utilities which are part of the Dinit distribution).</p>
<p class="Pp">When not running as a system manager, <b>dinit</b> assumes
    responsibility only for service management. System shutdown or restart need
    to be handled by the primary <b>init</b>, which should start <b>dinit</b> on
    normal startup, and terminate <b>dinit</b> before shutdown, by signalling it
    and waiting for it to terminate after stopping services (possibly by
    invoking <b>dinitctl shutdown</b>).</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="COMMAND_LINE_FROM_KERNEL"><a class="permalink" href="#COMMAND_LINE_FROM_KERNEL">COMMAND
  LINE FROM KERNEL</a></h1>
<p class="Pp">When running as PID 1, <b>dinit</b> may process the command line
    differently, to compensate for kernel behaviour.</p>
<p class="Pp">On Linux, kernel command line options that are not recognised by
    the kernel will be passed on to <b>dinit</b>. However, bugs in some kernel
    versions may cause some options that are recognised to also be passed to
    <b>dinit</b>. Also, boot managers may insert command-line options such as
    &quot;<b>auto</b>&quot; (which indicates an &quot;unattended&quot; boot).
    Therefore, <b>dinit</b> ignores all &quot;word like&quot; options other than
    &quot;<b>single</b>&quot;, which it treats as the name of the service to
    start (thus allowing &quot;single user mode&quot;, assuming that a suitable
    service description exists). Options beginning with &quot;<b>--</b>&quot;
    will not be recognised by the kernel and will be passed to (and processed
    by) <b>dinit</b>; for example <b>--quiet</b> can be used to suppress console
    output. Options containing &quot;=&quot; that are unrecognised by the kernel
    (or some that are, due to bugs) are passed to init via the environment
    rather than via the command line.</p>
<p class="Pp">There are several ways to work around this. Service names
    following the <b>--container</b> (<b>-o</b>) or <b>--system-mgr</b>
    (<b>-m</b>) options are not ignored. Also, the <b>--service</b> (<b>-t</b>)
    option can be used to force a service name to be recognised regardless of
    operating mode.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="FILES"><a class="permalink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag">
  <dt><i>/etc/dinit/environment</i></dt>
  <dd>Default location of the environment file for Dinit when run as a system
      instance (for user instances there is no default). Values are specified as
      <i>NAME</i>=<i>VALUE</i>, one per line, and add to and replace variables
      present in the environment when Dinit started (the &quot;original
      environment&quot;). Lines beginning with a hash character (#) are
    ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt></dt>
  <dd>The following special commands can be used (each on a single line):</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt><b>!clear</b></dt>
  <dd>Clears the environment completely (prevents inheritance of any variables
      from the original environment).</dd>
  <dt><b>!unset</b> <i>var-name</i>...</dt>
  <dd>Unsets the specified variables. Any previously specified value for these
      variables is forgotten, and they will not inherit any value from the
      original environment.</dd>
  <dt><b>!import</b> <i>var-name</i>...</dt>
  <dd>Imports the value of the named variables from the original environment,
      overriding the effect of any value set previously as well as the effect of
      previous <b>!unset</b> and <b>!clear</b> commands.</dd>
</dl>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SIGNALS"><a class="permalink" href="#SIGNALS">SIGNALS</a></h1>
<p class="Pp">When run as a system manager, SIGINT stops all services and
    performs a reboot (on Linux, this signal can be generated using the
    control-alt-delete key combination); SIGTERM stops services and halts the
    system; and SIGQUIT performs an immediate shutdown with no service
  rollback.</p>
<p class="Pp">When run as a user process or system service manager only, SIGINT
    and SIGTERM both stop services and exit Dinit; SIGQUIT exits Dinit
    immediately.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><b>dinitctl</b>(8), <b>dinit-service</b>(5),
  <b>dinitcheck</b>(8).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">Dinit, and this manual, were written by Davin McCall.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">October 2022</td>
    <td class="foot-os">Dinit 0.16.0</td>
  </tr>
</table>
</body>
</html>
