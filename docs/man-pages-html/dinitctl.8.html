<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DINITCTL(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DINITCTL(8)</td>
    <td class="head-vol">Dinit - service management system</td>
    <td class="head-rtitle">DINITCTL(8)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">dinitctl - control services supervised by Dinit</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>start</b>
    [<b>--no-wait</b>] [<b>--pin</b>] <i>service-name</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>stop</b> [<b>--no-wait</b>]
    [<b>--pin</b>] [<b>--ignore-unstarted</b>] <i>service-name</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>status</b>
    <i>service-name</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>restart</b>
    [<b>--no-wait</b>] [<b>--ignore-unstarted</b>] <i>service-name</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>wake</b> [<b>--no-wait</b>]
    <i>service-name</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>release</b>
    [<b>--ignore-unstarted</b>] <i>service-name</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>unpin</b>
    <i>service-name</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>unload</b>
    <i>service-name</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>reload</b>
    <i>service-name</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>list</b></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>shutdown</b></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>add-dep</b>
    <i>dependency-type</i> <i>from-service</i> <i>to-service</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>rm-dep</b>
    <i>dependency-type</i> <i>from-service</i> <i>to-service</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>enable</b> [<b>--from</b>
    <i>from-service</i>] <i>to-service</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>disable</b> [<b>--from</b>
    <i>from-service</i>] <i>to-service</i></p>
<p class="Pp HP"><b>dinitctl</b> [<i>options</i>] <b>setenv</b>
    [<i>name</i>[=<i>value</i>] <i>...</i>]</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><b>dinitctl</b> is a utility to control services being managed by
    the <b>dinit</b> daemon. It allows starting and stopping services, and
    listing service status, amongst other actions. It functions by issuing
    commands to the daemon via a control socket.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="GENERAL_OPTIONS"><a class="permalink" href="#GENERAL_OPTIONS">GENERAL
  OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt id="help"><a class="permalink" href="#help"><b>--help</b></a></dt>
  <dd>Display brief help text and then exit.</dd>
  <dt id="version"><a class="permalink" href="#version"><b>--version</b></a></dt>
  <dd>Display version and then exit.</dd>
  <dt id="s"><a class="permalink" href="#s"><b>-s</b>, <b>--system</b></a></dt>
  <dd>Control the system init process (this is the default when run as root).
      This option determines the default path to the control socket used to
      communicate with the <b>dinit</b> daemon process (it does not override the
      <b>-p</b> option).</dd>
  <dt id="u"><a class="permalink" href="#u"><b>-u</b>, <b>--user</b></a></dt>
  <dd>Control the user init process (this is the default when not run as root).
      This option determines the default path to the control socket used to
      communicate with the <b>dinit</b> daemon process (it does not override the
      <b>-p</b> option).</dd>
  <dt id="socket"><a class="permalink" href="#socket"><b>--socket-path</b>
    <i>socket-path</i>, <b>-p</b> <i>socket-path</i></a></dt>
  <dd>Specify the path to the socket used for communicating with the service
      manager daemon. When not specified, the value from the
      <b>DINIT_SOCKET_PATH</b> environment variable is used, with the default
      path (as documented for <b>dinit</b>(8)) used if the variable is
    unset.</dd>
  <dt id="quiet"><a class="permalink" href="#quiet"><b>--quiet</b></a></dt>
  <dd>Suppress status output, except for errors.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="COMMAND_OPTIONS"><a class="permalink" href="#COMMAND_OPTIONS">COMMAND
  OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt id="no"><a class="permalink" href="#no"><b>--no-wait</b></a></dt>
  <dd>Do not wait for issued command to complete; exit immediately.</dd>
  <dt id="pin"><a class="permalink" href="#pin"><b>--pin</b></a></dt>
  <dd>Pin the service in the requested state. The service will not leave the
      state until it is unpinned.
    <p class="Pp">A service that is pinned stopped cannot be marked active, that
        is, start commands issued to the service have no effect. Dependents (via
        hard dependency relationships) of the pinned service will be unable to
        start.</p>
    <p class="Pp">A service that is pinned started cannot be stopped, however
        its explicit activation can be removed (eg via the <b>stop</b> or
        <b>release</b> commands). Once unpinned, a service which is not
        explicitly activated, and which has no active dependents, will
        automatically stop. If a pinned-started service fails to start, the pin
        is removed.</p>
    <p class="Pp">Note that a pin takes effect while the service is
        starting/stopping, before it reaches the target state. Stopping or
        restarting a service that is pinned started and which is already
        starting or started is not possible. Similarly, starting a service which
        is pinned stopped and which is stopping or stopped is not possible.</p>
  </dd>
  <dt id="force"><a class="permalink" href="#force"><b>--force</b></a></dt>
  <dd>Stop the service even if it will require stopping other services which
      depend on the specified service. When applied to the <b>restart</b>
      command, this will cause the dependent services to also be restarted.</dd>
  <dt id="ignore"><a class="permalink" href="#ignore"><b>--ignore-unstarted</b></a></dt>
  <dd>If the service is not started or doesn't exist, ignore the command and
      return an exit code indicating success.</dd>
  <dt id="service_name"><a class="permalink" href="#service_name"><i>service-name</i></a></dt>
  <dd>Specifies the name of the service to which the command applies.</dd>
  <dt id="start"><a class="permalink" href="#start"><b>start</b></a></dt>
  <dd>Start the specified service. The service is marked as explicitly activated
      and will not be stopped automatically if its dependents stop. If the
      service is currently stopping it will generally continue to stop before it
      is then restarted.</dd>
  <dt id="stop"><a class="permalink" href="#stop"><b>stop</b></a></dt>
  <dd>Stop the specified service, and remove explicit activation. If the service
      has (non-soft) dependents, an error will be displayed and no further
      action taken, unless the <b>--force</b> option is used. If the service is
      pinned started (and not already stopped or stopping) an error will be
      displayed and no further action taken.
    <p class="Pp">The <b>restart</b> option (see <b>dinit-service</b>(5))
        applied to the stopped service will not cause the service to restart
        when it is stopped via this command (that is, this command inhibits
        automatic restart). This also applies to any dependents that must also
        be stopped at the same time.</p>
    <p class="Pp">Any pending <b>start</b> orders (including for restarts) are
        cancelled, though a service which is starting will continue its startup
        before then stopping (unless the service is configured to have an
        interruptible startup or is otherwise at a stage of startup which can be
        safely interrupted).</p>
  </dd>
  <dt id="status"><a class="permalink" href="#status"><b>status</b></a></dt>
  <dd>Give a status report on the specified service. This will show the current
      state (and target state, if different), and information such as process ID
      (pid) if applicable. If the service is stopped for any reason other than a
      normal stop, the reason for the service stopping will be displayed (along
      with any further relevant information, if available).</dd>
  <dt id="restart"><a class="permalink" href="#restart"><b>restart</b></a></dt>
  <dd>Restart the specified service. The service will be stopped and then
      restarted, without affecting explicit activation status or dependency
      links from dependents.</dd>
  <dt id="wake"><a class="permalink" href="#wake"><b>wake</b></a></dt>
  <dd>Start the specified service after reattaching dependency links from all
      active dependents of the specified service. The service will not be marked
      explicitly activated, and so will stop if all the dependents stop.</dd>
  <dt id="release"><a class="permalink" href="#release"><b>release</b></a></dt>
  <dd>Clear the explicit activation mark from a service (the service will then
      stop if it has no active dependents).</dd>
  <dt id="unpin"><a class="permalink" href="#unpin"><b>unpin</b></a></dt>
  <dd>Remove start- and stop- pins from a service. If a started service is not
      explicitly activated and has no active dependents, it will stop. If a
      started service has a dependency service which is stopping, it will stop.
      If a stopped service has a dependent service which is starting, it will
      start. Otherwise, any pending start/stop commands will be carried
    out.</dd>
  <dt id="unload"><a class="permalink" href="#unload"><b>unload</b></a></dt>
  <dd>Completely unload a service. This can only be done if the service is
      stopped and has no loaded dependents (i.e. dependents must be unloaded
      before their dependencies).</dd>
  <dt id="reload"><a class="permalink" href="#reload"><b>reload</b></a></dt>
  <dd>Attempt to reload a service description. This is intended as a convenience
      for making simple changes to a service, without having to stop, remove
      dependencies to and unload the service. However it is not completely
      equivalent to doing a proper unload/reload; some altered settings may not
      take effect until the service is restarted, and some cannot be changed at
      all while the service is running.
    <p class="Pp">In particular, the type of a running service cannot be
        changed; nor can the <b>inittab-id</b>, <b>inittab-line</b>, or
        <b>pid-file</b> settings, or the <b>runs-on-console</b> or
        <b>shares-console</b> flags. If any hard dependencies are added to a
        running service, the dependencies must already be started.</p>
  </dd>
  <dt id="list"><a class="permalink" href="#list"><b>list</b></a></dt>
  <dd>List loaded services and their state. Before each service, one of the
      following state indicators is displayed:
    <p class="Pp"></p>
  </dd>
</dl>
<div class="Bd-indent">
<pre>[{+}&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;] &#x2014; service has started.
[{&#x00A0;}&lt;&lt;&#x00A0;&#x00A0;&#x00A0;] &#x2014; service is starting.
[&#x00A0;&#x00A0;&#x00A0;&lt;&lt;{&#x00A0;}] &#x2014; service is starting, will stop once started.
[{&#x00A0;}&gt;&gt;&#x00A0;&#x00A0;&#x00A0;] &#x2014; service is stopping, will start once stopped.
[&#x00A0;&#x00A0;&#x00A0;&gt;&gt;{&#x00A0;}] &#x2014; service is stopping.
[&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{-}] &#x2014; service has stopped.</pre>
<p class="Pp">The &lt;&lt; and &gt;&gt; symbols represent a transition state
    (starting and stopping respectively); curly braces indicate the target state
    (left: started, right: stopped); square brackets are used if the service is
    marked active (target state will always be started if this is the case).</p>
<p class="Pp">An 's' in place of '+' means that the service startup was skipped
    (possible only if the service is configured as skippable). An 'X' in place
    of '-' means that the service failed to start, or that the service process
    unexpectedly terminated with an error status or signal while running.</p>
<p class="Pp">Additional information, if available, will be printed after the
    service name: whether the service owns, or is waiting to acquire, the
    console; the process ID; the exit status or signal that caused
  termination.</p>
</div>
<dl class="Bl-tag">
  <dt id="shutdown"><a class="permalink" href="#shutdown"><b>shutdown</b></a></dt>
  <dd>Stop all services (without restart) and terminate Dinit. If issued to the
      system instance of Dinit, this will also shut down the system.</dd>
  <dt id="add_dep"><a class="permalink" href="#add_dep"><b>add-dep</b></a></dt>
  <dd>Add a dependency between two services. The <i>dependency-type</i> must be
      one of <b>regular</b>, <b>milestone</b> or <b>waits-for</b>. Note that
      adding a regular dependency requires that the service states are
      consistent with the dependency (i.e. if the &quot;from&quot; service is
      started, the &quot;to&quot; service must also be started). Circular
      dependency chains may not be created.</dd>
  <dt id="rm_dep"><a class="permalink" href="#rm_dep"><b>rm-dep</b></a></dt>
  <dd>Remove a dependency between two services. The <i>dependency-type</i> must
      be one of <b>regular</b>, <b>milestone</b> or <b>waits-for</b>. If the
      &quot;to&quot; service is not otherwise active it may be stopped as a
      result of removing the dependency.</dd>
  <dt id="enable"><a class="permalink" href="#enable"><b>enable</b></a></dt>
  <dd>Persistently enable a <b>waits-for</b> dependency between two services.
      This is much like <b>add-dep</b> but it also starts the dependency if the
      dependent is started (without explicit activation, so the dependency will
      stop if the dependent stops), and it creates a symbolic link in the
      directory specified via the <b>waits-for.d</b> directive in the service
      description (there must be only one such directive) so that the dependency
      will survive between sessions.
    <p class="Pp">If the <b>--from</b> option is not used to specify the
        dependent, the dependency is created from the <b>boot</b> service by
        default.</p>
  </dd>
  <dt id="disable"><a class="permalink" href="#disable"><b>disable</b></a></dt>
  <dd>Permanently disable a <b>waits-for</b> dependency between two services.
      This is the complement of the <b>enable</b> command; see the description
      above for more information.
    <p class="Pp">Note that the <b>disable</b> command affects only the
        dependency specified (or implied). It has no other effect, and a service
        that is &quot;disabled&quot; may still be started if it is a dependency
        of another started service.</p>
  </dd>
  <dt id="setenv"><a class="permalink" href="#setenv"><b>setenv</b></a></dt>
  <dd>Export one or more variables into the activation environment. The value
      can be provided on the command line or retrieved from the environment
      <b>dinitctl</b> is called in. Any subsequently started or restarted
      service will have these environment variables available. This is
      particularly useful for user services that need access to session
      information.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="SERVICE_OPERATION"><a class="permalink" href="#SERVICE_OPERATION">SERVICE
  OPERATION</a></h1>
<p class="Pp">Normally, services are only started if they have been explicitly
    activated (<b>start</b> command) or if a started service depends on them.
    Therefore, starting a service also starts all services that the first
    depends on; stopping the same service then also stops the dependency
    services, unless they are also required by another explicitly activated
    service or have been explicitly activated themselves.</p>
<p class="Pp">A service can be pinned in either the started or stopped state.
    This is mainly intended to be used to prevent automated stop or start of a
    service, including via a dependency or dependent service, during a manual
    administrative procedure.</p>
<p class="Pp">Stopping a service manually will prevent it (and its dependents)
    from automatically restarting (i.e. it will override the <b>restart</b>
    setting in the service configuration).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="ENVIRONMENT_VARIABLES"><a class="permalink" href="#ENVIRONMENT_VARIABLES">ENVIRONMENT
  VARIABLES</a></h1>
<p class="Pp">The following environment variables may control <b>dinitctl</b>'s
    operation:</p>
<dl class="Bl-tag">
  <dt id="DINIT_SOCKET_PATH"><a class="permalink" href="#DINIT_SOCKET_PATH"><b>DINIT_SOCKET_PATH</b></a></dt>
  <dd>The path to the socket used to communicate with the <b>dinit</b>(8)
      daemon. May be overridden by certain command line options. If not set, and
      not overridden, the <b>dinit</b> defaults are used.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><b>dinit</b>(8), <b>dinit-service</b>(5).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">Dinit, and this manual, were written by Davin McCall.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">October 2022</td>
    <td class="foot-os">Dinit 0.16.0</td>
  </tr>
</table>
</body>
</html>
